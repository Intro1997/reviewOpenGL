These codes are as same as the tutorial. 